<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ðŸ¤– AUTO ASSIGNMENT HELPER VIEWS -->
    
    <!-- Auto Assignment Helper Form View -->
    <record id="hr_custody_auto_assignment_view_form" model="ir.ui.view">
        <field name="name">hr.custody.auto.assignment.form</field>
        <field name="model">hr.custody.auto.assignment</field>
        <field name="arch" type="xml">
            <form string="ðŸ¤– Auto Assignment Helper">
                <header>
                    <button name="process_untyped_attachments" 
                            string="ðŸ”§ Process All Untyped Photos" 
                            type="object" 
                            class="btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="id" invisible="1"/>
                            ðŸ¤– Auto Assignment Helper
                        </h1>
                    </div>
                    
                    <group>
                        <div class="alert alert-info" role="alert">
                            <h4>ðŸ“¸ Auto Photo Type Assignment</h4>
                            <p>This tool automatically assigns photo types to custody attachments that don't have one.</p>
                            <ul>
                                <li><strong>Handover Photos:</strong> Assigned to attachments when custody is in 'Approved' state</li>
                                <li><strong>Return Photos:</strong> Assigned to attachments when custody is in 'Returned' state</li>
                                <li><strong>Default:</strong> Handover photos for other states</li>
                            </ul>
                        </div>
                    </group>

                    <group>
                        <div class="alert alert-warning" role="alert">
                            <h4>ðŸ”„ Automated Processing</h4>
                            <p>
                                <strong>Hourly Cron Job:</strong> Automatically processes new photos every hour.<br/>
                                <strong>Manual Processing:</strong> Use the button above to process all untyped photos immediately.
                            </p>
                        </div>
                    </group>

                    <group string="ðŸ“Š Statistics" col="4">
                        <div class="oe_stat_button" name="untyped_photos_count">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value">
                                    <field name="untyped_photos_count" widget="statinfo"/>
                                </span>
                                <span class="o_stat_text">Untyped Photos</span>
                            </div>
                        </div>
                        
                        <div class="oe_stat_button" name="total_custody_photos">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value">
                                    <field name="total_custody_photos" widget="statinfo"/>
                                </span>
                                <span class="o_stat_text">Total Custody Photos</span>
                            </div>
                        </div>
                        
                        <div class="oe_stat_button" name="recent_uploads">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value">
                                    <field name="recent_uploads" widget="statinfo"/>
                                </span>
                                <span class="o_stat_text">Recent Uploads (24h)</span>
                            </div>
                        </div>
                        
                        <div class="oe_stat_button" name="processed_today">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value">
                                    <field name="processed_today" widget="statinfo"/>
                                </span>
                                <span class="o_stat_text">Processed Today</span>
                            </div>
                        </div>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ðŸ”§ FIXED: Auto Assignment Helper Action with CORRECT External ID -->
    <record id="hr_custody_auto_assignment_action_form" model="ir.actions.act_window">
        <field name="name">ðŸ¤– Auto Assignment Helper</field>
        <field name="res_model">hr.custody.auto.assignment</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="hr_custody_auto_assignment_view_form"/>
        <field name="target">new</field>
        <field name="context">{'default_id': 1}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                ðŸ¤– Auto-assign photo types to custody attachments.
            </p>
            <p>This tool helps assign photo types to uploaded photos automatically based on custody state.</p>
        </field>
    </record>

</odoo>